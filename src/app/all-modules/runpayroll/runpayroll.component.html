<div class="row">
  <div class="col-sm-10">
    <div class="d-flex align-items-baseline">
      <i
        style="font-size: 20px"
        class="fa fa-arrow-left"
        routerLink="/dashboard"
        aria-label="back"></i>
      <h3 class="ms-4 page-title">Run Payroll</h3>
    </div>
  </div>
  <div class="col-sm-2">
    <!-- <label class="form-label ms-2">Show entries</label>
    <select class="form-select" (change)="resultsPerPage($event)">
      <option value="25">25</option>
      <option value="50">50</option>
      <option value="100">100</option>
      <option value="all">All</option>
    </select> -->
  </div>
</div>

<div class="row">
  <div class="col-md-12">
    <div class="row">
      <div class="col-md-3">
        <div class="form-group">
          <label class="col-form-label" for="payrollCode">Payroll </label>
          <select
            class="form-select"
            (change)="onPayrollChange()"
            [(ngModel)]="payrollCode">
            <option [value] selected disabled>Select Payroll</option>
            <option *ngFor="let pc of payrollsetups" [value]="pc.payrollCode">
              {{ pc.payrollCode }}
            </option>
          </select>
        </div>
      </div>
      <div class="col-md-2">
        <div class="form-group">
          <label class="col-form-label" for="Date">Date </label>
          <input
            class="form-control"
            type="month"
            [max]="maxDt"
            *ngIf="salaryFrequency === 'Month'"
            placeholder="Month/YYYY"
            [(ngModel)]="fulldate" />

          <input
            class="form-control"
            type="date"
            [max]="maxDt"
            *ngIf="salaryFrequency !== 'Month'"
            placeholder="dd/MM/YYYY"
            [(ngModel)]="fulldate" />
        </div>
      </div>
      <div class="col-md">
        
      </div>
    </div>
    <div class="row mb-3">
      <div
        class="col-sm-6 col-md d-flex align-items-center justify-content-end">
        <button
          (click)="submit()"
          class="btn add-btn mx-2"
          [disabled]="!fulldate">
          Submit
        </button>
        <button
          id="approve_timesheet"
          class="btn success-btn float-end mx-2"
          [disabled]="!runpayroll"
          (click)="runPayroll()">
          Run Payroll
        </button>
      </div>
    </div>

    <div class="card card-border-style p-3">
      <div class="row">
        <div class="col-md-10">
          <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
            <li class="nav-item my-1" role="presentation">
              <button
                (click)="tab5()"
                class="nav-link active"
                id="pills-needValidation-tab"
                data-bs-toggle="pill"
                data-bs-target="#pills-needValidation"
                type="button"
                role="tab"
                aria-controls="pills-needValidation"
                aria-selected="true">
                Need Validation Timesheets
              </button>
            </li>
            <li class="nav-item ms-2 my-1" role="presentation">
              <button
                (click)="tab1()"
                class="nav-link"
                id="pills-unapprovedTimesheet-tab"
                data-bs-toggle="pill"
                data-bs-target="#pills-unapprovedTimesheet"
                type="button"
                role="tab"
                aria-controls="pills-unapprovedTimesheet"
                aria-selected="true">
                Unapproved Timesheets
              </button>
            </li>
            <li
              class="nav-item ms-2 my-1"
              role="presentation"
              id="tab_leave_unapproved_leaves">
              <button
                (click)="tab2()"
                class="nav-link"
                id="pills-unapprovedLeaves-tab"
                data-bs-toggle="pill"
                data-bs-target="#pills-unapprovedLeaves"
                type="button"
                role="tab"
                aria-controls="pills-unapprovedLeaves"
                aria-selected="false">
                Unapproved Leaves
              </button>
            </li>
            <li
              class="nav-item ms-2 my-1"
              role="presentation"
              id="tab_approvedTimesheet">
              <button
                (click)="tab3()"
                class="nav-link"
                [disabled]="!fulldate"
                id="pills-approvedTimesheet-tab"
                data-bs-toggle="pill"
                data-bs-target="#pills-approvedTimesheet"
                type="button"
                role="tab"
                aria-controls="pills-approvedTimesheet"
                aria-selected="false">
                Approved Timesheet
              </button>
            </li>
            <li
              class="nav-item ms-2 my-1"
              role="presentation"
              id="tab_leave_approved">
              <button
                (click)="tab4()"
                [disabled]="!fulldate"
                class="nav-link"
                id="pills-approvedLeaves-tab"
                data-bs-toggle="pill"
                data-bs-target="#pills-approvedLeaves"
                type="button"
                role="tab"
                aria-controls="pills-approvedLeaves"
                aria-selected="false">
                Approved Leaves
              </button>
            </li>
          </ul>
        </div>

        <div class="col-md-2">
          <div class="row">
            <div class="col-md-12 col-sm-12">
              <button
                *ngIf="firstTab && hasPermissionToApprove"
                id="approve_timesheet"
                class="btn success-btn float-end my-2 mx-2"
                [disabled]="approvedRowsPost.length === 0"
                (click)="approveRecord()">
                Approve
              </button>

              <button
                *ngIf="secondTab && hasPermissionToApprove"
                id="approve_timesheet"
                class="btn success-btn float-end my-2 mx-2"
                [disabled]="approvedLeavesPost.length === 0"
                (click)="approveLeaves()">
                Approve Leave
              </button>
              <button
                *ngIf="secondTab  && hasPermissionToApprove"
                id="approve_timesheet"
                class="btn delete-btn float-end my-2 mx-2"
                [disabled]="approvedLeavesPost.length === 0"
                (click)="rejectLeave()">
                Reject Leave
              </button>

            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-md-12">
          <div class="tab-content" id="pills-tabContent">

            <!-- need validation records started -->

            <div
              class="tab-pane fade show active "
              id="pills-needValidation"
              role="tabpanel"
              aria-labelledby="pills-needValidation-tab"
              tabindex="0">
              <div class="row">
                <div class="col-md-12">
                  <div class="table-responsive">
                    <table
                      datatable
                      class="table table-hover custom-table mb-0 datatable">
                      <thead class="thead-all">
                        <tr class="tr-th-all">
                          <th></th>
                          <th>
                            Date
                            <i
                              class="fa fa-sort"
                              data-column="dateCode"
                              (click)="sortData('dateCode')"
                              [ngClass]="{
                          asc: sortColumn === 'dateCode' && sortOrder === 'asc',
                          desc:
                            sortColumn === 'dateCode' && sortOrder === 'desc'
                        }"></i>
                          </th>
                          <th>
                            Employee Name
                            <i
                              class="fa fa-sort"
                              data-column="employeeName"
                              (click)="sortData('employeeName')"
                              [ngClass]="{
                          asc:
                            sortColumn === 'employeeName' &&
                            sortOrder === 'asc',
                          desc:
                            sortColumn === 'employeeName' &&
                            sortOrder === 'desc'
                        }"></i>
                          </th>
                          <th class>Shift</th>
                          <th class="text-center">Is Holiday</th>
                          <th class="text-center">Is Week Off</th>
                          <th class>Work Hrs</th>
                          <th class="text-center">
                            Total Hrs
                            <i
                              class="fa fa-sort"
                              data-column="totalHours1"
                              (click)="sortData('totalHours1')"
                              [ngClass]="{
                          asc:
                            sortColumn === 'totalHours1' && sortOrder === 'asc',
                          desc:
                            sortColumn === 'totalHours1' && sortOrder === 'desc'
                        }"></i>
                          </th>
                          <th class="text-center">
                            Effective Hrs
                            <i
                              class="fa fa-sort"
                              data-column="effectiveHrs1"
                              (click)="sortData('effectiveHrs1')"
                              [ngClass]="{
                          asc:
                            sortColumn === 'effectiveHrs1' && sortOrder === 'asc',
                          desc:
                            sortColumn === 'effectiveHrs1' && sortOrder === 'desc'
                        }"></i>
                          </th>
                          <th>Comment</th>
                          <th class="text-center"
                            *ngIf="needvalidationRecords.length > 0">Action</th>
                        </tr>
                      </thead>
                      <tbody *ngIf="needvalidationRecords.length === 0">
                        <tr
                          style=" text-align: center; height: 150px;">
                          <td colspan="12">
                            "No records were found with the selected filter criteria."
                          </td>
                        </tr>
                      </tbody>
                      <tbody
                        *ngFor="let vnr of needvalidationRecords;let i = index">
                        <tr *ngIf="vnr.needValidation === true"
                          class="dasboard-td">
                          <td><i *ngIf="!vnr.expand" class="fa fa-plus"
                              aria-hidden="true" (click)="expandRow(vnr)"></i>
                            <i *ngIf="vnr.expand" class="fa fa-minus"
                              aria-hidden="true" (click)="collapseRow(vnr)"></i>
                          </td>
                          <td>{{ vnr.dateCode | date : dateFormat }}</td>
                          <td>
                            {{ vnr.employeeName }} <br />
                            <span class="text-muted">
                              {{ vnr.employeeCode }}
                            </span>
                          </td>
                          <td>
                            <span *ngIf="!vnr?.inDateEditMode">
                              <b class="edit-cal">{{ vnr.shift }}
                              </b>
                            </span>
                            <div
                              *ngIf="vnr?.inDateEditMode"
                              style="display: inline-flex"
                              class="mb-1">
                              <select id="shift" style="width: auto;"
                                class="form-select" [(ngModel)]="vnr.shift">
                                <!--  (change)="changeShift(vnr, i, 'IN', 'fromValiNeeded')" -->
                                <option value>-</option>
                                <option [value]="sh.shiftCode"
                                  *ngFor="let sh of allShifts">{{sh.shiftCode}}</option>
                              </select>
                            </div>
                          </td>
                          <td class="text-center">
                            <i
                              *ngIf="vnr.isHoliday"
                              class="fa-solid fa-circle"
                              style="color: #55ce63"></i>
                            <i
                              *ngIf="!vnr.isHoliday"
                              class="fa-solid fa-circle"
                              style="color: #f62d51"></i>
                          </td>
                          <td class="text-center">
                            <i
                              *ngIf="vnr.isWeeklyOff"
                              class="fa-solid fa-circle"
                              style="color: #55ce63"></i>
                            <i
                              *ngIf="!vnr.isWeeklyOff"
                              class="fa-solid fa-circle"
                              style="color: #f62d51"></i>
                          </td>

                          <td class>
                            <span *ngIf="!vnr?.inDateEditMode">
                              In-Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                              <b class="edit-cal">{{ vnr.inDate }}
                                {{ vnr.inTime  }}
                              </b>
                            </span>
                            <div
                              *ngIf="vnr?.inDateEditMode"
                              style="display: inline-flex"
                              class="mb-1">
                              <input
                                type="date"
                                min="{{vnr.minMinDate}}"
                                max="{{vnr.minDate}}"
                                class="form-control"
                                [(ngModel)]="vnr.inDate"
                                (change)="
                            timeDifference(vnr, i, 'IN', 'fromValiNeeded')
                          "
                                style="height: 36px; width: 158px" />
                              <input
                                type="time"
                                class="form-control ms-2"
                                [(ngModel)]="vnr.inTime"
                                (change)="
                            timeDifference(vnr, i, 'IN', 'fromValiNeeded')
                          "
                                style="height: 36px; width: 158px" />
                            </div>
                            <br />
                            <span
                              *ngIf="!vnr?.outDateEditMode"
                              style="margin-top: -10px">
                              Out-Date:&nbsp;&nbsp;&nbsp;
                              <b class="edit-cal">{{ vnr.outDate }}
                                {{ vnr.outTime  }}
                              </b>
                            </span>
                            <div
                              *ngIf="vnr?.outDateEditMode"
                              style="display: inline-flex"
                              class>
                              <input
                                type="date"
                                class="form-control"
                                [(ngModel)]="vnr.outDate"
                                min="{{ vnr.minDate }}"
                                max="{{ vnr.maxDate }}"
                                (change)="timeDifference(vnr, i, 'OUT', 'fromValiNeeded')"
                                style="height: 36px; width: 158px" />
                              <input
                                type="time"
                                step="2"
                                class="form-control ms-2"
                                [(ngModel)]="vnr.outTime"
                                (change)="timeDifference(vnr, i, 'OUT', 'fromValiNeeded')"
                                style="height: 36px; width: 158px" />
                            </div>
                          </td>
                          <td class="text-center">{{ vnr?.totalHours1 }}</td>
                          <td class="text-center"> {{ vnr?.effectiveHrs1 }}</td>
                          <td>{{vnr.comments}}</td>
                          <td class="text-center">
                            <div class="btn-group" role="group">
                              <button
                                type="button"
                                *ngIf="!(vnr?.inDateEdit || vnr?.outDateEdit)"
                                class="btn btn-sm btn-primary edit-button"
                                data-toggle="tooltip"
                                title="Edit"
                                (click)="editData(vnr)">
                                <i class="fa-solid fa-pencil me-1"></i>
                              </button>
                              <button
                                type="button"
                                *ngIf="!(vnr?.inDateEdit || vnr?.outDateEdit)"
                                class="btn btn-sm btn-light view-button"
                                data-toggle="tooltip"
                                data-bs-target="#viewRecord"
                                data-bs-toggle="modal"
                                title="view"
                                (click)="viewData(vnr)">
                                <i class="fa-solid fa-eye me-1"></i>
                              </button>
                              <button
                                type="button"
                                *ngIf="vnr?.inDateEdit || vnr?.outDateEdit && hasPermissionToUpdate"
                                [disabled]="!vnr.outDate ||!vnr.outTime || !vnr.inDate || !vnr.inTime "
                                class="btn btn-sm btn-success edit-button"
                                data-toggle="tooltip"
                                title="save"
                                (click)="saveRow(vnr)">
                                <i class=" fa-solid fa fa-save"></i>
                              </button>
                              <button
                                type="button"
                                *ngIf="vnr?.inDateEdit || vnr?.outDateEdit && hasPermissionToUpdate"
                                class="btn btn-sm btn-danger edit-button"
                                data-toggle="tooltip"
                                title="Undo"
                                (click)="Undo(vnr, i, 'fromValiNeeded')">
                                <i class="fa-solid fa fa-undo"></i>
                              </button>
                            </div>
                          </td>
                        </tr>
                        <tr *ngIf="vnr.expand">
                          <td colspan="12" *ngIf="vnr.loading === 'loading'">
                            <mat-progress-bar mode="query"></mat-progress-bar>
                          </td>
                          <td colspan="12" style="padding: 0"
                            *ngIf="vnr.loading === 'success'">
                            <table
                              class="table table-bordered table-responsive-sm">
                              <thead class="thead-all">
                                <tr class="tr-th-all">
                                  <th scope="col">Date</th>
                                  <th scope="col">Employee Code</th>
                                  <th scope="col">Time</th>
                                  <th scope="col">IN/OUT</th>
                                  <th scope="col">Device Id</th>
                                  <th scope="col">Status</th>
                                  <th scope="col">Comments</th>
                                  <th scope="col">Processed?</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr class="dasboard-td"
                                  *ngFor="let item of vnr.logRecords">
                                  <td>{{item.dateCode | date :dateFormat}}</td>
                                  <td>{{item.employeeRefCode}}</td>
                                  <td>{{item.attTime }}</td>
                                  <td>{{item.status}}</td>
                                  <td>{{item.deviceId}}</td>
                                  <td>{{item.attStatus}}</td>
                                  <td>{{item.comments}}</td>
                                  <td>{{item.isProcessed}}</td>
                                </tr>
                                <tr *ngIf="vnr.logRecords.length === 0"
                                  style=" text-align: center; height: 150px;">
                                  <td colspan="12">
                                    "No records were found"
                                  </td>
                                </tr>
                              </tbody>
                            </table>
                          </td>
                        </tr>

                      </tbody>
                    </table>
                    <!-- <div
                  *ngIf="needvalidationRecords.length > needvalidationRecordsConfig.itemsPerPage"
                  class="text-center mt-3">
                  <pagination-controls
                    (pageChange)="pageChangedeedvalidation($event)"></pagination-controls>
                </div> -->
                  </div>
                </div>
              </div>
            </div>
            <!-- need validation records ends -->
            <!-- un approved records starts -->
            <div
              class="tab-pane fade"
              id="pills-unapprovedTimesheet"
              role="tabpanel"
              aria-labelledby="pills-unapprovedTimesheet-tab"
              tabindex="0">
              <!-- *ngIf="!leaveRecords" -->
              <div class="table-responsive">
                <table
                  class="table table-hover small table-nowrap custom-table mb-0 datatable">
                  <thead class="thead-all">
                    <tr class="tr-th-all">
                      <th
                        scope="col"
                        *ngIf="unapprovedRecords.length > 0 && hasPermissionToApprove"
                        class="d-flex my-2 border-0">
                        <div>
                          <input
                            type="checkbox"
                            [checked]="checked"
                            (change)="approveAllTimesheetItem($event)"
                            style="zoom: 1.4" />
                        </div>
                        <div style="margin-left: 4px; padding: 2px">
                          <i
                            class="fa fa-info-circle red-tooltip"
                            aria-hidden="true"
                            data-bs-toggle="tooltip"
                            data-bs-placement="top"
                            data-bs-custom-class="custom-tooltip"
                            title="To Select all Records"></i>
                        </div>
                      </th>
                      <th>
                        Date<i
                          class="fa fa-sort ms-1"
                          data-column="dateCode"
                          (click)="sortData('dateCode')"
                          [ngClass]="{
                            asc:
                              sortColumn === 'dateCode' && sortOrder === 'asc',
                            desc:
                              sortColumn === 'dateCode' && sortOrder === 'desc'
                          }"></i>
                      </th>
                      <th>
                        Employee Name<i
                          class="fa fa-sort ms-1"
                          data-column="employeeName"
                          (click)="sortData('employeeName')"
                          [ngClass]="{
                            asc:
                              sortColumn === 'employeeName' &&
                              sortOrder === 'asc',
                            desc:
                              sortColumn === 'employeeName' &&
                              sortOrder === 'desc'
                          }"></i>
                      </th>
                      <th class>Shift</th>
                      <th class="text-center">Is Holiday</th>
                      <th class="text-center">Is Week Off</th>
                      <th class>Work Hrs</th>
                      <th class="text-center">
                        Total Hrs<i
                          class="fa fa-sort ms-1"
                          data-column="totalHours1"
                          (click)="sortData('totalHours1')"
                          [ngClass]="{
                            asc:
                              sortColumn === 'totalHours1' &&
                              sortOrder === 'asc',
                            desc:
                              sortColumn === 'totalHours1' &&
                              sortOrder === 'desc'
                          }"></i>
                      </th>
                      <th class="text-center">
                        Effective Hrs<i
                          class="fa fa-sort ms-1"
                          data-column="effectiveHrs1"
                          (click)="sortData('effectiveHrs1')"
                          [ngClass]="{
                            asc:
                              sortColumn === 'effectiveHrs1' &&
                              sortOrder === 'asc',
                            desc:
                              sortColumn === 'effectiveHrs1' &&
                              sortOrder === 'desc'
                          }"></i>
                      </th>
                      <th>Comments</th>
                      <!-- <th class="text-center"
                                    *ngIf="unapprovedRecords.length > 0">
                                    Action
                                </th> -->
                    </tr>
                  </thead>
                  <tbody *ngIf="!clickedOnSubmit">
                    <tr style="text-align: center; height: 150px">
                      <td colspan="9">
                        "Finalize your selection by clicking 'Submit' to
                        generate records with the filtered data you've chosen."
                      </td>
                    </tr>
                  </tbody>
                  <tbody
                    *ngIf="unapprovedRecords.length === 0 && clickedOnSubmit">
                    <tr style="text-align: center; height: 150px">
                      <td colspan="9">
                        "Hooray! all records are approved."
                      </td>
                    </tr>
                  </tbody>

                  <tbody *ngIf="unapprovedRecords.length > 0">
                    <ng-container
                      *ngFor="
                        let row of unapprovedRecords 
                        let i = index
                      ">
                      <!-- | paginate : config; -->
                      <tr class="dasboard-td" *ngIf="row.isApproved !== true">
                        <td *ngIf="hasPermissionToApprove">
                          <input
                            type="checkbox"
                            [ngModel]="row?.approved"
                            (click)="approveItem($event, row)"
                            style="zoom: 1.4" />
                        </td>
                        <td>{{ row.dateCode | date : dateFormat }}</td>
                        <td>
                          {{ row.employeeName }} <br />
                          <span class="text-muted">
                            {{ row.employeeCode }}
                          </span>
                        </td>
                        <td class>{{ row.shift }}</td>
                        <td class="text-center">
                          <i
                            *ngIf="row.isHoliday"
                            class="fa-solid fa-circle"
                            style="color: #55ce63"></i>
                          <i
                            *ngIf="!row.isHoliday"
                            class="fa-solid fa-circle"
                            style="color: #f62d51"></i>
                        </td>
                        <td class="text-center">
                          <i
                            *ngIf="row.isWeeklyOff"
                            class="fa-solid fa-circle"
                            style="color: #55ce63"></i>
                          <i
                            *ngIf="!row.isWeeklyOff"
                            class="fa-solid fa-circle"
                            style="color: #f62d51"></i>
                        </td>
                        <td class>
                          <span *ngIf="!row?.inDateEditMode">
                            In-Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            <b class="edit-cal">{{ row.inDate }}
                              {{ row.inTime  }}
                            </b>
                          </span>
                          <div
                            *ngIf="row?.inDateEditMode"
                            style="display: inline-flex"
                            class="mb-1">
                            <input
                              type="date"
                              class="form-control"
                              min="{{ row.minDate }}"
                              max="{{ row.maxDate }}"
                              [(ngModel)]="row.inDate"
                              (change)="
                                timeDifference(row, i, 'IN', 'fromUnApproved')
                              "
                              style="height: 36px; width: 158px" />
                            <input
                              type="time"
                              class="form-control ms-2"
                              [(ngModel)]="row.inTime"
                              (change)="
                                timeDifference(row, i, 'IN', 'fromUnApproved')
                              "
                              style="height: 36px; width: 158px" />
                          </div>
                          <br />
                          <span
                            *ngIf="!row?.outDateEditMode"
                            style="margin-top: -10px">
                            Out-Date:&nbsp;&nbsp;&nbsp;
                            <b class="edit-cal">{{ row.outDate }}
                              {{ row.outTime  }}
                            </b>
                          </span>
                          <div
                            *ngIf="row?.outDateEditMode"
                            style="display: inline-flex"
                            class>
                            <input
                              type="date"
                              class="form-control"
                              [(ngModel)]="row.outDate"
                              min="{{ row.minDate }}"
                              max="{{ row.maxDate }}"
                              (change)="
                                timeDifference(row, i, 'OUT', 'fromUnApproved')
                              "
                              style="height: 36px; width: 158px" />
                            <input
                              type="time"
                              step="2"
                              class="form-control ms-2"
                              [(ngModel)]="row.outTime"
                              (change)="
                                timeDifference(row, i, 'OUT', 'fromUnApproved')"
                              style="height: 36px; width: 158px" />
                          </div>
                        </td>
                        <td class="text-center">
                          {{ row?.totalHours1 }}
                        </td>
                        <td class="text-center">{{ row?.effectiveHrs1 }}</td>
                        <td>
                          {{ row?.comments }}
                        </td>
                      </tr>
                    </ng-container>
                  </tbody>
                </table>
                <!-- <div
                  *ngIf="unapprovedRecords.length > config.itemsPerPage"
                  class="text-center mt-3">
                  <pagination-controls
                    (pageChange)="pageChanged($event)"></pagination-controls>
                </div> -->
              </div>
            </div>
            <!-- un approved records ends -->

            <!-- leave unapproved records starts -->
            <div
              class="tab-pane fade"
              id="pills-unapprovedLeaves"
              role="tabpanel"
              aria-labelledby="pills-unapprovedLeaves-tab"
              tabindex="0">
              <div class="table-responsive">
                <table
                  class="table table-hover small table-nowrap custom-table mb-0 datatable">
                  <thead class="thead-all">
                    <tr class="tr-th-all">
                      <th
                        scope="col"
                        *ngIf="leavesNeedToApprove.length > 0 && hasPermissionToApprove"
                        class="d-flex my-2 border-0">
                        <div>
                          <input
                            type="checkbox"
                            [checked]="checkedLeaves"
                            (change)="checkAllLeaveRecords($event)"
                            style="zoom: 1.4" />
                        </div>
                        <div style="margin-left: 4px; padding: 2px">
                          <i
                            class="fa fa-info-circle red-tooltip"
                            aria-hidden="true"
                            data-bs-toggle="tooltip"
                            data-bs-placement="top"
                            data-bs-custom-class="custom-tooltip"
                            title="To Select all Records"></i>
                        </div>
                      </th>
                      <th>
                        From Date568<i
                          class="fa fa-sort ms-1"
                          data-column="leaveFromdate"
                          (click)="sortData('leaveFromdate')"
                          [ngClass]="{
                            asc:
                              sortColumn === 'leaveFromdate' &&
                              sortOrder === 'asc',
                            desc:
                              sortColumn === 'leaveFromdate' &&
                              sortOrder === 'desc'
                          }"></i>
                      </th>
                      <th>
                        To Date<i
                          class="fa fa-sort ms-1"
                          data-column="leaveTodate"
                          (click)="sortData('leaveTodate')"
                          [ngClass]="{
                            asc:
                              sortColumn === 'leaveTodate' &&
                              sortOrder === 'asc',
                            desc:
                              sortColumn === 'leaveTodate' &&
                              sortOrder === 'desc'
                          }"></i>
                      </th>
                      <th>
                        Employee Name<i
                          class="fa fa-sort ms-1"
                          data-column="employeeName"
                          (click)="sortData('employeeName')"
                          [ngClass]="{
                            asc:
                              sortColumn === 'employeeName' &&
                              sortOrder === 'asc',
                            desc:
                              sortColumn === 'employeeName' &&
                              sortOrder === 'desc'
                          }"></i>
                      </th>
                      <th class>Leave Type</th>
                      <th class="text-end">Number Of Leaves</th>
                      <th class="text-center">Status</th>

                      <!-- <th class="text-center"
                                    *ngIf="leavesNeedToApprove.length > 0">
                                    Action
                                </th> -->
                    </tr>
                  </thead>

                  <tbody *ngIf="!clickedOnSubmit">
                    <tr style="text-align: center; height: 150px">
                      <td colspan="9">
                        "Finalize your selection by clicking 'Submit' to
                        generate records with the filtered data you've chosen."
                      </td>
                    </tr>
                  </tbody>
                  <tbody
                    *ngIf="leavesNeedToApprove.length === 0 && clickedOnSubmit">
                    <tr style="text-align: center; height: 150px">
                      <td colspan="9">
                        "Hooray! all records are approved."
                      </td>
                    </tr>
                  </tbody>

                  <tbody *ngIf="leavesNeedToApprove.length > 0">
                    <ng-container
                      *ngFor="
                        let row of leavesNeedToApprove;
                        let i = index
                      ">
                      <!-- | paginate : leavesNeedToApproveConfig -->
                      <tr
                        class="dasboard-td"
                        *ngIf="row.removeRecords === false">
                        <td *ngIf="hasPermissionToApprove">
                          <input
                            type="checkbox"
                            [ngModel]="row?.checkedLeaveItems"
                            (click)="approveLeaveItem($event, row)"
                            style="zoom: 1.4" />
                        </td>
                        <td>{{ row.leaveFromdate | date : dateFormat }}</td>
                        <td>{{ row.leaveTodate | date : dateFormat }}</td>
                        <td>
                          {{ row.employeeName }} <br />
                          <span class="text-muted">
                            {{ row.employeeCode }}
                          </span>
                        </td>
                        <td class>{{ row.leaveTypeCode }}</td>
                        <td class="text-end">
                          {{ row.numLeaves }}
                        </td>
                        <td class="text-center">{{ row.status }}</td>
                      </tr>
                    </ng-container>
                  </tbody>
                </table>
                <!-- <div
                  *ngIf="leavesNeedToApprove.length > leavesNeedToApproveConfig.itemsPerPage"
                  class="text-center mt-3">
                  <pagination-controls
                    (pageChange)="pageChangedForleavesNeedToApproveConfig($event)"></pagination-controls>
                </div> -->
              </div>
            </div>
            <!-- leave unapproved records ends -->

            <!-- approved timesheet starts -->
            <div
              class="tab-pane fade"
              id="pills-approvedTimesheet"
              role="tabpanel"
              aria-labelledby="pills-approvedTimesheet-tab"
              tabindex="0">
              <div class="table-responsive">
                <table
                  class="table table-hover small table-nowrap custom-table mb-0 datatable">
                  <thead class="thead-all">
                    <tr class="tr-th-all">
                      <th>
                        Date<i
                          class="fa fa-sort ms-1"
                          data-column="dateCode"
                          (click)="sortData('dateCode')"
                          [ngClass]="{
                            asc:
                              sortColumn === 'dateCode' && sortOrder === 'asc',
                            desc:
                              sortColumn === 'dateCode' && sortOrder === 'desc'
                          }"></i>
                      </th>
                      <th>
                        Employee Name<i
                          class="fa fa-sort ms-1"
                          data-column="employeeName"
                          (click)="sortData('employeeName')"
                          [ngClass]="{
                            asc:
                              sortColumn === 'employeeName' &&
                              sortOrder === 'asc',
                            desc:
                              sortColumn === 'employeeName' &&
                              sortOrder === 'desc'
                          }"></i>
                      </th>
                      <th class>Shift</th>
                      <th class="text-center">Is Holiday</th>
                      <th class="text-center">Is Week Off</th>
                      <th class>Work Hrs</th>
                      <th class="text-center">
                        Total Hrs<i
                          class="fa fa-sort ms-1"
                          data-column="totalHours1"
                          (click)="sortData('totalHours1')"
                          [ngClass]="{
                            asc:
                              sortColumn === 'totalHours1' &&
                              sortOrder === 'asc',
                            desc:
                              sortColumn === 'totalHours1' &&
                              sortOrder === 'desc'
                          }"></i>
                      </th>
                      <th class="text-center">
                        Effective Hrs<i
                          class="fa fa-sort ms-1"
                          data-column="effectiveHrs1"
                          (click)="sortData('effectiveHrs1')"
                          [ngClass]="{
                            asc:
                              sortColumn === 'effectiveHrs1' &&
                              sortOrder === 'asc',
                            desc:
                              sortColumn === 'effectiveHrs1' &&
                              sortOrder === 'desc'
                          }"></i>
                      </th>
                      <th>Finalized</th>
                    </tr>
                  </thead>

                  <tbody *ngIf="approvedTimesheetRecords.length === 0">
                    <tr style="text-align: center; height: 150px">
                      <td colspan="9">
                        "Hooray! all records are approved."
                      </td>
                    </tr>
                  </tbody>

                  <tbody *ngIf="approvedTimesheetRecords.length > 0">
                    <ng-container
                      *ngFor="
                        let row of approvedTimesheetRecords;
                        let i = index
                      ">
                      <!-- | paginate : approveTimesheetconfig -->
                      <tr class="dasboard-td">
                        <!-- <ng-container *ngIf=" row.isApproved !== true"> -->
                        <td>{{ row.dateCode | date : dateFormat }}</td>
                        <td>
                          {{ row.employeeName }} <br />
                          <span class="text-muted">
                            {{ row.employeeCode }}
                          </span>
                        </td>
                        <td class>{{ row.shift }}</td>
                        <td class="text-center">
                          <i
                            *ngIf="row.isHoliday"
                            class="fa-solid fa-circle"
                            style="color: #55ce63"></i>
                          <i
                            *ngIf="!row.isHoliday"
                            class="fa-solid fa-circle"
                            style="color: #f62d51"></i>
                        </td>
                        <td class="text-center">
                          <i
                            *ngIf="row.isWeeklyOff"
                            class="fa-solid fa-circle"
                            style="color: #55ce63"></i>
                          <i
                            *ngIf="!row.isWeeklyOff"
                            class="fa-solid fa-circle"
                            style="color: #f62d51"></i>
                        </td>
                        <td class>
                          <span *ngIf="!row?.inDateEditMode">
                            In-Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            <b class="edit-cal">{{ row.inDate }}
                              {{ row.inTime  }}
                            </b>
                          </span>
                          <div
                            *ngIf="row?.inDateEditMode"
                            style="display: inline-flex"
                            class="mb-1">
                            <input
                              type="date"
                              class="form-control"
                              min="{{ row.minDate }}"
                              max="{{ row.maxDate }}"
                              [(ngModel)]="row.inDate"
                              (change)="
                                timeDifference(row, i, 'IN', 'fromUnApproved')
                              "
                              style="height: 36px; width: 158px" />
                            <input
                              type="time"
                              class="form-control ms-2"
                              [(ngModel)]="row.inTime"
                              (change)="
                                timeDifference(row, i, 'IN', 'fromUnApproved')
                              "
                              style="height: 36px; width: 158px" />
                          </div>
                          <br />
                          <span
                            *ngIf="!row?.outDateEditMode"
                            style="margin-top: -10px">
                            Out-Date:&nbsp;&nbsp;&nbsp;
                            <b class="edit-cal">{{ row.outDate }}
                              {{ row.outTime  }}
                            </b>
                          </span>
                          <div
                            *ngIf="row?.outDateEditMode"
                            style="display: inline-flex"
                            class>
                            <input
                              type="date"
                              class="form-control"
                              [(ngModel)]="row.outDate"
                              min="{{ row.minDate }}"
                              max="{{ row.maxDate }}"
                              (change)="
                                timeDifference(row, i, 'OUT', 'fromUnApproved')
                              "
                              style="height: 36px; width: 158px" />
                            <input
                              type="time"
                              step="2"
                              class="form-control ms-2"
                              [(ngModel)]="row.outTime"
                              (change)="
                                timeDifference(row, i, 'OUT', 'fromUnApproved')
                              "
                              style="height: 36px; width: 158px" />
                          </div>
                        </td>

                        <td class="text-center">
                          {{ row?.totalHours1 }}
                        </td>
                        <td class="text-center">{{ row?.effectiveHrs1 }}</td>
                        <td class="text-center">
                          <i
                            *ngIf="row.isFinalized"
                            class="fa-solid fa-circle"
                            style="color: #55ce63"></i>
                          <i
                            *ngIf="!row.isFinalized"
                            class="fa-solid fa-circle"
                            style="color: #f62d51"></i>
                        </td>

                      </tr>
                    </ng-container>
                  </tbody>
                </table>
                <!-- <div
                  *ngIf="approvedTimesheetRecords.length > approveTimesheetconfig.itemsPerPage"
                  class="text-center mt-3">
                  <pagination-controls
                    (pageChange)="pageChangedForapproveTimesheetconfig($event)"></pagination-controls>
                </div> -->
              </div>
            </div>
            <!-- approved timesheet ends -->

            <!-- approved leaves starts -->
            <div
              class="tab-pane fade"
              id="pills-approvedLeaves"
              role="tabpanel"
              aria-labelledby="pills-approvedLeaves-tab"
              tabindex="0">
              <div class="table-responsive">
                <table
                  class="table table-hover small table-nowrap custom-table mb-0 datatable">
                  <thead class="thead-all">
                    <tr class="tr-th-all">

                      <th>
                        From Date<i
                          class="fa fa-sort ms-1"
                          data-column="leaveFromdate"
                          (click)="sortData('leaveFromdate')"
                          [ngClass]="{
                            asc:
                              sortColumn === 'leaveFromdate' &&
                              sortOrder === 'asc',
                            desc:
                              sortColumn === 'leaveFromdate' &&
                              sortOrder === 'desc'
                          }"></i>
                      </th>
                      <th>
                        To Date<i
                          class="fa fa-sort ms-1"
                          data-column="leaveTodate"
                          (click)="sortData('leaveTodate')"
                          [ngClass]="{
                            asc:
                              sortColumn === 'leaveTodate' &&
                              sortOrder === 'asc',
                            desc:
                              sortColumn === 'leaveTodate' &&
                              sortOrder === 'desc'
                          }"></i>
                      </th>
                      <th>
                        Employee Name<i
                          class="fa fa-sort ms-1"
                          data-column="employeeName"
                          (click)="sortData('employeeName')"
                          [ngClass]="{
                            asc:
                              sortColumn === 'employeeName' &&
                              sortOrder === 'asc',
                            desc:
                              sortColumn === 'employeeName' &&
                              sortOrder === 'desc'
                          }"></i>
                      </th>
                      <th class>Leave Type</th>
                      <th class="text-end">Number Of Leaves</th>
                      <th class="text-center">Status</th>
                    </tr>
                  </thead>

                  <tbody
                    *ngIf="approvedLeavesRecords.length === 0">
                    <tr style="text-align: center; height: 150px">
                      <td colspan="9">
                        "No records Found."
                      </td>
                    </tr>
                  </tbody>

                  <tbody *ngIf="approvedLeavesRecords.length > 0">
                    <ng-container
                      *ngFor="
                        let row of approvedLeavesRecords ;
                        let i = index
                      ">
                      <!-- | paginate : approveLeavesconfig -->
                      <tr
                        class="dasboard-td">
                        <td>{{ row.leaveFromdate | date : dateFormat }}</td>
                        <td>{{ row.leaveTodate | date : dateFormat }}</td>
                        <td>
                          {{ row.employeeName }} <br />
                          <span class="text-muted">
                            {{ row.employeeCode }}
                          </span>
                        </td>
                        <td class>{{ row.leaveTypeCode }}</td>
                        <td class="text-end">
                          {{ row.numLeaves }}
                        </td>
                        <td class="text-center">{{ row.status }}</td>
                      </tr>
                    </ng-container>
                  </tbody>
                </table>
                <!-- <div
                  *ngIf="approvedLeavesRecords.length > approveLeavesconfig.itemsPerPage"
                  class="text-center mt-3">
                  <pagination-controls
                    (pageChange)="pageChanged($event)"></pagination-controls>
                </div> -->
              </div>
            </div>
            <!-- approved leaves ends -->

          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div id="viewRecord" class="modal custom-modal fade" role="dialog">
  <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Time Sheet</h5>
        <button
          id="timesheetclose"
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"></button>
      </div>

      <div class="modal-body">
        <div class="row">
          <div class="col-md-12 text-center">
            <span class="block my-2">Date :
              {{ view?.dateCode | date : dateFormat }}
            </span>
            <span class="my-2">Comment:
              {{ view?.comments ? view?.comments : "-" }}
            </span>
          </div>
          <div class="col-md-6">
            <section class="border-bottom p-2"
              style="border: 1px solid; border-color: #8e958e55; border-radius: 10px;">
              <h5 class="border-bottom p-2">Details</h5>
              <table class="w-100">
                <tbody>
                  <tr class="p-2"><td class="text-muted">Employee code
                      :</td><td>{{view?.employeeCode}}</td></tr>
                  <tr class="p-2"><td class="text-muted">Employee name : </td>
                    <td> {{view?.employeeName}} </td></tr>
                  <tr class="p-2"><td class="text-muted"> Shift :</td>
                    <td>{{view?.shift}}</td> </tr>
                  <tr class="p-2"><td class="text-muted"> Branch :</td> <td>
                      {{view?.branchCode}}</td></tr>
                  <tr class="p-2"> <td class="text-muted"> Company
                      :</td><td>{{view?.companyCode}}</td> </tr>
                </tbody>
              </table>
            </section>

            <section class="border-bottom p-2 my-2"
              style="border: 1px solid; border-color: #8e958e55; border-radius: 10px;">
              <h5 class="border-bottom p-2">Status</h5>
              <table class="w-100">
                <tbody>
                  <tr class="p-2"><td class="text-muted"> Entry Status
                      :</td><td>{{ view?.entryStatus}}</td> </tr>
                  <tr class="p-2"><td class="text-muted">Entry Hrs : </td><td>{{
                      view?.entryHrs }}</td></tr>
                  <tr class="p-2"><td class="text-muted"> Exit Status :</td><td>
                      {{ view?.exitStatus }}</td></tr>
                  <tr class="p-2"><td class="text-muted"> Exit Hrs : </td><td>{{
                      view?.exitHrs }}</td></tr>
                  <tr class="p-2"><td class="text-muted"> Is Holiday :</td>
                    <td>{{ view?.isHoliday }}</td></tr>
                  <tr class="p-2"><td class="text-muted"> Is WeeklyOff :</td>
                    <td>{{view?.isWeeklyOff }}</td></tr>
                  <tr class="p-2"><td class="text-muted">Status:</td><td>{{
                      view?.status }}</td></tr>
                  <tr class="p-2"><td class="text-muted"> Need Validation :</td>
                    <td>{{ view?.needValidation }}</td> </tr>
                  <tr class="p-2"><td class="text-muted"> Is Finalized :</td>
                    <td>{{ view?.isFinalized }}</td> </tr>
                  <tr class="p-2"><td class="text-muted"> Approved :</td> <td>{{
                      view?.isApproved }}</td> </tr>
                </tbody></table>
            </section>
          </div>

          <div class="col-md-6">
            <section class="border-bottom p-2"
              style="border: 1px solid; border-color: #8e958e55; border-radius: 10px;">
              <h5 class="border-bottom p-2">Attendance Details</h5>
              <table class="w-100">
                <tbody>
                  <tr class="p-2"><td class="text-muted">In Date
                      :</td><td>{{view?.inDate | date : dateFormat}}</td> </tr>
                  <tr class="p-2"><td class="text-muted"> In Time :</td><td>{{
                      view?.inTime }}</td> </tr>
                  <tr class="p-2"><td class="text-muted"> Out Date :</td><td>{{
                      view?.outDate | date : dateFormat}}</td> </tr>
                  <tr class="p-2"><td class="text-muted"> Out Time :</td><td>{{
                      view?.outTime }}</td> </tr>
                  <tr class="p-2"><td class="text-muted"> Total Hours
                      :</td><td>{{ view?.totalHours1}}</td> </tr>
                  <tr class="p-2"><td class="text-muted"> Effective Hours
                      :</td><td>{{ view?.effectiveHrs1}}</td> </tr>
                  <tr class="p-2"><td class="text-muted"> OT Hours :</td><td>{{
                      view?.otHours}}</td> </tr>
                  <tr class="p-2"><td class="text-muted"> Regular Hours
                      :</td><td>{{ view?.regularhours}}</td> </tr>
                  <tr class="p-2"><td class="text-muted"> Attendance Status
                      :</td><td>{{ view?.attStatus}}</td> </tr>
                </tbody>
              </table>
            </section>

            <section class="border-bottom p-2 my-2"
              style="border: 1px solid; border-color: #8e958e55; border-radius: 10px;">
              <h5 class="border-bottom p-2">Device</h5>
              <table>
                <tbody>
                  <tr class="p-2"><td class="text-muted"> In Device :</td><td>{{
                      view?.inDevice}}</td> </tr>
                  <tr class="p-2"><td class="text-muted"> In Location
                      :</td><td>{{ view?.inLocation}}</td> </tr>
                  <tr class="p-2"><td class="text-muted">Last In Time
                      :</td><td>{{ view?.lastInTime}}</td> </tr>
                  <tr class="p-2"><td class="text-muted"> Out Device
                      :</td><td>{{ view?.outDevice}}</td> </tr>
                  <tr class="p-2"><td class="text-muted"> Out Location
                      :</td><td>{{ view?.outLocation}}</td> </tr>

                </tbody>
              </table>
            </section>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>
